<!DOCTYPE html>
<html lang="en">


<!-- Mirrored from themes.pixelstrap.com/voxo/front-end/user-dashboard.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 19 Dec 2023 05:48:41 GMT -->
<head>
    <link rel="manifest" href="manifest.json" />
    <link rel="icon" href="/assetssss/images/favicon/2.png" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/assetssss/images/favicon/2.png" />
    <meta name="theme-color" content="#e22454" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="apple-mobile-web-app-title" content="Voxo" />
    <meta name="msapplication-TileImage" content="/assetssss/images/favicon/2.png" />
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="preconnect" href="https://fonts.googleapis.com/" />
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
    <link rel="preconnect" href="https://fonts.googleapis.com/" />
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Voxo">
    <meta name="keywords" content="Voxo">
    <meta name="author" content="Voxo">
    <link rel="icon" href="/assetssss/images/favicon/2.png" type="image/x-icon" />
    <title>DashBoard</title>

    <!-- Google font -->
    <link rel="preconnect" href="https://fonts.gstatic.com/">
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;600;700&amp;display=swap" rel="stylesheet">

    <!-- bootstrap css -->
    <link id="rtl-link" rel="stylesheet" type="text/css" href="/assetssss/css/vendors/bootstrap.css">

    <!-- font-awesome css -->
    <link rel="stylesheet" type="text/css" href="/assetssss/css/vendors/font-awesome.css">

    <!-- feather icon css -->
    <link rel="stylesheet" type="text/css" href="/assetssss/css/vendors/feather-icon.css">

    <!-- animation css -->
    <link rel="stylesheet" type="text/css" href="/assetssss/css/vendors/animate.css">

    <!-- slick css -->
    <link rel="stylesheet" type="text/css" href="/assetssss/css/vendors/slick/slick.css">
    <link rel="stylesheet" type="text/css" href="/assetssss/css/vendors/slick/slick-theme.css">

    <!-- Theme css -->
    <link id="color-link" rel="stylesheet" type="text/css" href="/assetssss/css/demo2.css">
    <script src="
    https://cdn.jsdelivr.net/npm/sweetalert2@11.10.1/dist/sweetalert2.all.min.js
    "></script>
    <link href="
    https://cdn.jsdelivr.net/npm/sweetalert2@11.10.1/dist/sweetalert2.min.css
    " rel="stylesheet">
    <style>
        .black-btn {
    background-color: black; /* Set the background color to black */
    color: white; /* Set the text color to white or any contrasting color */
    /* Add any other styling you want for the black button */
}
    </style>

</head>

<body class="theme-color2 light ltr">

    

    <!-- mobile fix menu start -->
    <div class="mobile-menu d-sm-none">
        <ul>
            <li>
                <a href="index.html">
                    <i data-feather="home"></i>
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="javascript:void(0)" class="toggle-category">
                    <i data-feather="align-justify"></i>
                    <span>Category</span>
                </a>
            </li>
            <li>
                <a href="cart.html">
                    <i data-feather="shopping-bag"></i>
                    <span>Cart</span>
                </a>
            </li>
            <li>
                <a href="wishlist.html">
                    <i data-feather="heart"></i>
                    <span>Wishlist</span>
                </a>
            </li>
            <li>
                <a href="user-dashboard.html" class="active">
                    <i data-feather="user"></i>
                    <span>Account</span>
                </a>
            </li>
        </ul>
    </div>
    <!-- mobile fix menu end -->

    <!-- Breadcrumb section start -->
    <section class="breadcrumb-section section-b-space">
        <ul class="circles">
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
        </ul>
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <h3>My Orders History</h3>
                    <nav>
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item">
                                <a href="/">
                                    <i class="fas fa-home"></i>
                                </a>
                            </li>
                            
                        </ol>
                    </nav>
                </div>
            </div>
        </div>
    </section>
    <!-- Breadcrumb section end -->

    <!-- user dashboard section start -->
    
                    

                   
                        <div class="tab-pane table-dashboard dashboard wish-list-section" id="order">
                            <div class="box-head mb-3">
                                <h3></h3>
                            </div>
                            <div class="table-responsive">
                                <table class="table cart-table">
                                    <thead>
                                        <tr class="table-head">
                                            <th scope="col">image</th>
                                            <th scope="col">Order Id</th>
                                            <th scope="col">Product Details</th>
                                            <th scope="col">Status</th>
                                            <th scope="col">Price</th>
                                            <th scope="col">View</th>
                                            <th scope="col">Action</th>

                                        </tr>
                                    </thead>
                                    <tbody>
                                        <% if (orders.length > 0) { %>
                                            <% console.log('s1'); %>
                                            <% orders.reverse().forEach(item => { %>
                                                <% console.log('s1'); %>
                                                <% if (item.products && item.products.length > 0) { %>
                                                    <% console.log('s1'); %>
                                                    <% item.products.forEach(box => { %>
                                                        <% console.log('s1'); %>
                                                        <% let product = box.product; %>
                                                        <% console.log('/////'+box); %>
                                                        <tr>
                                                            <td>
                                                                <a href="product-left-sidebar.html">
                                                                    <img src="<%= product.singleImage %>" class="blur-up lazyload" alt="">
                                                                </a>
                                                            </td>
                                                            <td>
                                                                <p class="mt-0">#<%= item.order_id %></p>
                                                            </td>
                                                            <td>
                                                                <p class="fs-6 m-0"><%= product.name %></p>
                                                              

                                                            </td>
                                                            <td>
                                                                <% if (item.status === 'Pending') { %>
                                                                    <p class="success-button btn btn-sm">Pending</p>
                                                                <% } else if (item.status === 'Shipped') { %>
                                                                    <p class="success-button btn btn-sm">Shipped</p>
                                                                <% } else if (item.status === 'Cancelled') { %>
                                                                    <p class="danger-button btn btn-sm">Canceled</p>
                                                                <% } else if (item.status === 'Delivered') { %>
                                                                    <p class="success-button btn btn-sm">Delivered</p>
                                                                <% } else if (item.status === 'returned') { %>
                                                                <p class="danger-button btn btn-sm">returned</p>
                                                                <% } else { %>
                                                                    <p class="danger-button btn btn-sm">Status not available</p>
                                                                <% } %> 

                                                            </td>
                                                            <td>
                                                                <p class=" fs-6">â‚¹<%= product.price %></p>
                                                            </td>
                                                            <td>
                                                                <a href="/productorder/<%= product._id %>">
                                                                    <i class="far fa-eye"></i>
                                                                </a>
                                                            </td>
                                                            <td>
                                                                <% if(item.status === 'Delivered' ) {%>
                                                                <a href="javascript:void(0)">
                                                                    <p class="danger-button btn btn-bg black-btn" onclick="getreturn('<%= item._id %>,<%= product._id %>')">Return</p>

                                                                </a>
                                                                <% } else if(item.status === 'returned') { %>
                                                                    <a href="javascript:void(0)">
                                                                        <p class="danger-button btn btn-bg black-btn" onclick="getreturn('<%= item._id %>,<%= product._id %>')">Returned</p>
    
                                                                    </a>
                                                                </a>
                                                                <% } else if(item.status === 'Cancelled') { %>
                                                                    <a href="javascript:void(0)">
                                                                    <p class="danger-button btn btn-bg" style="background-color: gray;">Canceled</p>
                                                                    </a>
                                                                    <%} else { %>

                                                                <a href="javascript:void(0)">
                                                                <p class="danger-button btn btn-bg" onclick="getid('<%= product._id %>')">Cancel</p>
                                                                </a>

                                                                <%}%>
                                                            </td>
                                                        </tr>
                                                    <% }); %>
                                                <% } else { %>
                                                    <!-- Handle case where products array is empty or undefined -->
                                                    <tr>
                                                        <td colspan="6">No products for this order</td>
                                                    </tr>
                                                <% } %>
                                            <% }); %>
                                        <% } else { %>
                                            <!-- Handle case where orders array is empty -->
                                            <tr>
                                                <td colspan="6">No orders available</td>
                                            </tr>
                                        <% } %>
                                    </tbody>
                                    
                                </table>
                            </div>
                        </div>

                       
    <!-- Subscribe Section Start -->
    <section class="subscribe-section section-b-space">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-md-6">
                    <div class="subscribe-details">
                        <h2 class="mb-3">Subscribe Our News</h2>
                        <h6 class="font-light">Subscribe and receive our newsletters to follow the news about our fresh
                            and fantastic Products.</h6>
                    </div>
                </div>

                <div class="col-lg-4 col-md-6 mt-md-0 mt-3">
                    <div class="subsribe-input">
                        <div class="input-group">
                            <input type="text" class="form-control subscribe-input" placeholder="Your Email Address">
                            <button class="btn btn-solid-default" type="button">Button</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Subscribe Section End -->

    

    <!-- tap to top Section End -->

    <div class="bg-overlay"></div>

    <!-- latest jquery-->
    <script src="/assetssss/js/jquery-3.5.1.min.js"></script>

    <!-- Add To Home js -->
    <script src="/assetssss/js/pwa.js"></script>

    <!-- Bootstrap js-->
    <script src="/assetssss/js/bootstrap/bootstrap.bundle.min.js"></script>

    <!-- feather icon js-->
    <script src="/assetssss/js/feather/feather.min.js"></script>

    <!-- lazyload js-->
    <script src="/assetssss/js/lazysizes.min.js"></script>

    <!-- Slick js-->
    <script src="/assetssss/js/slick/slick.js"></script>
    <script src="/assetssss/js/slick/slick-animation.min.js"></script>
    <script src="/assetssss/js/slick/custom_slick.js"></script>

    <!-- Filter Hide and show Js -->
    <script src="/assetssss/js/filter.js"></script>

    <!-- Notify js-->
    <script src="/assetssss/js/bootstrap/bootstrap-notify.min.js"></script>

    <!-- script js -->
    <script src="/assetssss/js/theme-setting.js"></script>
    <script src="/assetssss/js/script.js"></script>
    <script>
       
       let productId = '';

function getid(selectedProductId) {
    productId = selectedProductId;
    
    showconfirmation();
}

async function showconfirmation() {
    try {
        const swalWithBootstrapButtons = Swal.mixin({
            customClass: {
                confirmButton: "btn btn-success",
                cancelButton: "btn btn-danger"
            },
            buttonsStyling: false
        });

        const result = await swalWithBootstrapButtons.fire({
            title: "Are you sure?",
            text: "You won't be able to revert this!",
            icon: "warning",
            showCancelButton: true,
            confirmButtonText: "Cancel Order!",
            cancelButtonText: "No Back!",
            reverseButtons: true
        });

        if (result.isConfirmed) {
            const response = await fetch(`/cancelorder`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ productId })
            });

            if (response.ok) {
                Swal.fire({
                    title: "Cancelled!",
                    text: "Your operation has been cancelled.",
                    icon: "success"
                }).then(()=>{
                    setTimeout(() => {
                        window.location.reload();
                    }, 500);
                })
            } else {
                Swal.fire({
                    title: "Error",
                    text: "Unable to cancel the operation.",
                    icon: "error"
                });
            }
        } else if (result.dismiss === Swal.DismissReason.cancel) {
            Swal.fire({
                title: "Cancelled",
                text: "",
                icon: "error"
            });
        }
    } catch (error) {
        console.error(error);
        // Handle any unexpected errors
    }
}

async function getreturn(orderId,productId){
    alert(orderId,productId)

    const orderIds = orderId.split(',');

    const response = await fetch('/returnorder',{
        method: 'post',
        headers: {
        'Content-Type': 'application/json'
        },
        body: JSON.stringify({ orderId:orderIds,productId:productId})

    });

    const data = await response.json()
    
    if (data && data.message==='Order returned') {
					Swal.fire({
						title: "Order returned !!",
						
						icon: "success",
					}).then(() => {
                    setTimeout(()=>{
						location.reload(); 
					},1000)
                    
                });
				} else if(data && data.message==='Order already returned'){
                    Swal.fire({
						title: "Order already returned",
						
						icon: "success",
					}).then(() => {
                    setTimeout(()=>{
						location.reload(); 
					},1000)
                    
                });

                }
                else {
					Swal.fire({
						title: "Order can't return !",
						
						icon: "error",
					})
				}
}


    </script>

</body>


<!-- Mirrored from themes.pixelstrap.com/voxo/front-end/user-dashboard.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 19 Dec 2023 05:48:43 GMT -->
</html>